<!DOCTYPE html>
<html>
<head>
    <title>Image Selector</title>
      <style>
        #container {
            display: flex;
        }

        #leftPanel {
            flex: 1;
            padding: 20px;
        }

        #rightPanel {
            flex: 1;
            padding: 20px;
        }
        
        #noImageText {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            font-weight: bold;
            color: red;
            display: none;
        }
        
        #imageInfo {
            text-align: center;
            font-weight: bold;
            font-size: 25px;
            margin-bottom: 10px;
        }
    </style>
    <script>

        function selectImage() {
            var day = document.getElementById("day").value;
            var month = document.getElementById("month").value;
            var year = document.getElementById("year").value;
            var channel = document.getElementById("channel").value;

            var imagePath = "./" + year + "/" + month + "/" + day + "/" + channel + ".spec.png";
            var image = document.getElementById("selectedImage");
            var noImageText = document.getElementById("noImageText");
            var imageInfo = document.getElementById("imageInfo");

            image.src = imagePath;
            image.onerror = function() {
                image.style.display = "none";
                noImageText.style.display = "block";
            };

            image.style.display = "block";
            noImageText.style.display = "none";
            imageInfo.innerHTML = "Station: " + channel + " | Year: " + year + " | Month: " + month + " | Day: " + day;
            
        }

        function handleKeyPress(event) {
            if (event.keyCode === 37) { // Left arrow key
		var day = Math.max( Number(document.getElementById("day").value) - 1, 1) ; // Decrease date, minimum 1
                document.getElementById("day").value = day ;
                selectImage();
            } else if (event.keyCode === 39) { // Right arrow key
		var day = Math.min( Number(document.getElementById("day").value) + 1, 31) ; // Increase date, maximum 31
                document.getElementById("day").value = day ; 
                selectImage();
            } else if (event.keyCode === 38) { // Up arrow key
                changeChannel(-1); // Move to the previous channel
                selectImage();
            } else if (event.keyCode === 40) { // Down arrow key
                changeChannel(1); // Move to the next channel
                selectImage();
            }
            
        }


        function changeChannel(direction) {
            var channelSelect = document.getElementById("channel");
            var selectedIndex = channelSelect.selectedIndex;
            var newIndex = selectedIndex + direction;
            var optionsCount = channelSelect.options.length;

            if (newIndex < 0) {
                newIndex = optionsCount - 1; // Wrap to the last option
            } else if (newIndex >= optionsCount) {
                newIndex = 0; // Wrap to the first option
            }

            channelSelect.selectedIndex = newIndex;
            currentChannel = channelSelect.value;
        }
        
        function setDefaultImage() {
	    var date = new Date()
	    document.getElementById("day").value = date.getUTCDate().toString();
	    document.getElementById("month").value = String(date.getUTCMonth() + 1);
	    document.getElementById("year").value = date.getUTCFullYear().toString();
            selectImage(); // Select default image
        }

        document.addEventListener('keydown', handleKeyPress);
        window.onload = setDefaultImage;

    </script>
</head>
<body>
  <div id="container">
        <div id="leftPanel">
            <label for="channel">Channel:</label>
            <select id="channel">
                <option value="9S.BRIZ1..EHZ">9S.BRIZ1..EHZ</option>
                <option value="9S.BRIZ2..EHZ">9S.BRIZ2..EHZ</option>
                <!-- Add more channels here -->
            </select>
            <br>
            <label for="year">Year:</label>
            <input type="number" id="year" min="1970" max="2070" value="2023">
            <br>
            <label for="month">Month:</label>
            <select id="month">
                <option value="1">January</option>
                <option value="2">February</option>
                <option value="3">March</option>
                <option value="4">April</option>
                <option value="5">May</option>
                <option value="6">June</option>
                <option value="7">July</option>
                <option value="8">August</option>
                <option value="9">September</option>
                <option value="10">October</option>
                <option value="11">November</option>
                <option value="12">December</option>
            </select>
            <br>
            <label for="day">Day:</label>
            <input type="number" id="day" min="1" max="31">
            <br>
            <button onclick="selectImage()">Select Image</button>
        </div>
        <div id="rightPanel">
            <div id="imageInfo"></div>
            <img id="selectedImage" src="" alt="Selected Image">
            <div id="noImageText">No spectrogram available</div>
        </div>
    </div>

</body>
</html>
